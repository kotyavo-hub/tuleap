.PHONY: first-start
first-start: wipe-containers prepare-backend prepare-fronted dev-setup start post-checkout

.PHONY: wipe-containers
wipe-containers:
	docker-compose rm --stop --force -v
	docker-compose down --volumes --remove-orphans

.PHONY: prepare-backend
prepare-backend:
	make composer

.PHONY: prepare-fronted
prepare-frontend:
	docker-compose -f docker-compose-dev.yml run --rm node npm install
	docker-compose -f docker-compose-dev.yml run --rm node npm run build

.PHONY: dev-setup
dev-setup:
	make dev-setup

.PHONY: start
start:
	make start

.PHONY: post-checkout
post-checkout:
	make post-checkout

.PHONY: follow-error-log
follow-error-log:
	docker-compose exec web bash -c "tail -F /var/log/tuleap/codendi_syslog"

.PHONY: exec
exec:
	docker-compose exec web tuleap $(cmd)
